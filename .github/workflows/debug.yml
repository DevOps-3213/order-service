name: Workflow for testing

on:
  push:
  workflow_dispatch:
    inputs:
      failJob:
        description: Fail the job?
        type: boolean
        required: true
        default: false

jobs:
  deploy:
    name: Deploy
    runs-on: ubuntu-22.04

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Create tmp json file
        run: |
          tmp=$(mktemp)
          image=${{ env.GITHUB_REF_NAME }}
          jq '.containerDefinitions[0].image = $image' task-definition.json > "$tmp" && mv "$tmp" test.json
          cat test.json

      - name: Load env variables
        uses: cardinalby/export-env-action@v1
        with:
          envFile: "variables.env"
          expand: "true"

      - name: debug
        run: echo ${{ env.GITHUB_REF_NAME }}
